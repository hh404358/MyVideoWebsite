webpackJsonp([4],{INfE:function(e,t){},hy4u:function(e,t,s){"use strict";t.d=function(){return Object(a.a)({url:"/user/focus",method:"get"})},t.c=function(){return Object(a.a)({url:"/user/fans",method:"get"})},t.e=function(){return Object(a.a)({url:"/user/friends",method:"get"})},t.a=function(e){return Object(a.a)({url:"/user/addFocus",method:"post",params:{focusId:e}})},t.b=function(e){return Object(a.a)({url:"/user/cancelFocus",method:"delete",params:{focusId:e}})};var a=s("vLgD")},psK5:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("bOdI"),o=s.n(a),i=s("Cz8s"),n=s("vMJZ"),l=s("IcnI"),r=s("jN9j"),c=s("hy4u"),u={data:function(){return{fixDo:!1,loveme:!1,gotoTop:!1,going:!1,focusList:"",fanList:"",friendList:""}},methods:{toTopfun:function(e){var t=this;this.gotoTop=!1,this.going=!0;var s=setInterval(function(){var e=document.documentElement.scrollTop||document.body.scrollTop,a=Math.floor(-e/7);document.documentElement.scrollTop=document.body.scrollTop=e+a,0==e&&(t.going=!1,clearInterval(s),s=null)},30)},getFanList:function(){var e=this;Object(c.c)().then(function(t){e.fanList=t})},getFocusList:function(){var e=this;Object(c.d)().then(function(t){e.focusList=t})},getFriendList:function(){var e=this;Object(c.e)().then(function(t){e.friendList=t})}},components:{},created:function(){var e=this;window.onscroll=function(){var t=document.documentElement.scrollTop||document.body.scrollTop;e.going||(e.gotoTop=t>600),e.fixDo=t>1200},this.getFanList(),this.getFocusList(),this.getFriendList()}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"box"},[s("section",{staticClass:"rs4"},[s("h2",{staticClass:"ui label"},[e._v("粉丝列表")]),e._v(" "),s("ul",e._l(e.fanList,function(t,a){return s("li",{key:"fanList"+a},[s("img",{attrs:{src:"item.avatar"}}),e._v(e._s(t.nickName)+"\n              \n            ")])})),e._v(" "),s("h2",{staticClass:"ui label"},[e._v("关注列表")]),e._v(" "),s("ul",e._l(e.focusList,function(t,a){return s("li",{key:"fanList"+a},[s("img",{attrs:{src:"item.avatar"}}),e._v(e._s(t.nickName)+"\n              \n            ")])})),e._v(" "),s("h2",{staticClass:"ui label"},[e._v("朋友列表")]),e._v(" "),s("ul",e._l(e.friendList,function(t,a){return s("li",{key:"fanList"+a},[s("img",{attrs:{src:"item.avatar"}}),e._v(e._s(t.nickName)+"\n              \n            ")])}))]),e._v(" "),0!=this.$store.state.themeObj.user_start?s("div",{class:e.gotoTop?"toTop hidden":"toTop goTop hidden",on:{click:e.toTopfun}},[s("img",{attrs:{src:this.$store.state.themeObj.right_img?this.$store.state.themeObj.right_img:"static/img/scroll.png",alt:""}})]):s("div",{class:e.gotoTop?"toTophui hidden":"toTophui goTophui hidden",on:{click:e.toTopfun}},[s("img",{attrs:{src:this.$store.state.themeObj.right_img?this.$store.state.themeObj.right_img:"static/img/scroll.png",alt:""}})])])},staticRenderFns:[]};var v,f=s("VU/8")(u,d,!1,function(e){s("ubdi")},null,null).exports,m={name:"UserInfo",data:function(){return{uploadURL:"",isEdit:!1,userInfo:{},userInfoObj:"",video:{videoTitle:"",videoInfo:"",videoTypeId:[],videoUrl:"",thunmbnailUrl:""},videoAccept:"video/*",isVideo:!1,fileList:[],uploadURL1:"",uploadURL2:"",loading:!1}},methods:(v={handleAvatarSuccess:function(e,t){200==e.code?(this.userInfoObj.avatar=e.data,console.log("imgurl:"+e.data),this.userInfoObj.head_start=1):this.$message.error("上传图片失败")},beforeAvatarUpload:function(e){var t="image/png"==e.type||"image/jpg"==e.type||"image/jpeg"==e.type,s=e.size/1024/1024<1;return console.log(e),t||this.$message.error("上传头像图片只能是 JPG/JPEG/PNG 格式!"),s||this.$message.error("上传头像图片大小不能超过 1MB!"),console.log("res:"+(t&&s)),t&&s},saveInfoFun:function(){var e=this;console.log("save:"),e.userInfoObj.nickName?Object(n.d)(e.userInfoObj).then(function(t){e.$message.success("保存成功！"),e.isEdit=!1,e.routeChange()}):e.$message.error("昵称为必填项，请填写昵称")},handleUploadImg:function(e){var t=this;uploadImg(e.file).then(function(s){t.form.thunmbnailUrl=s,t.fileList.push({name:e.file.name,url:s})}).catch(function(e){t.$message.error(e.msg)})},handleUploadVideo:function(e){var t=this;uploadVideo(e.file).then(function(s){t.form.videoUrl=s,t.fileList.push({name:e.file.name,url:s})}).catch(function(e){t.$message.error(e.msg)})},fileRemove:function(e,t){this.fileList.pop()},addImg:function(e,t){var s=this;uploadImg(t).then(function(t){s.$refs.md.$img2Url(e,t)}).catch(function(e){s.$message.error(e.msg)})},addVideo:function(e,t){var s=this;uploadVideo(t).then(function(t){s.$refs.md.$img2Url(e,t)}).catch(function(e){s.$message.error(e.msg)})}},o()(v,"beforeAvatarUpload",function(e){var t="image/jpeg"===e.type,s=e.size/1024/1024<2;return s||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&s}),o()(v,"saveVideo",function(){var e=this;console.log("save:"+e.video.videoTitle),e.video.videoTitle?e.video.videoInfo?e.video.videoTypeId?(this.video.videoTypeId=parseInt(this.video.videoTypeId),console.log("video:"+e.video),Object(r.a)(e.video).then(function(t){e.$message.success("保存成功！"),e.isVideo=!1,e.routeChange()})):e.$message.error("视频类型为必选项，请填写"):e.$message.error("视频详情为必填项，请填写"):e.$message.error("视频标题为必填项，请填写")}),o()(v,"routeChange",function(){var e=this;localStorage.getItem("userInfo")?(e.haslogin=!0,e.userInfo=JSON.parse(localStorage.getItem("userInfo")),e.userId=e.userInfo.id,Object(n.b)(e.userId).then(function(t){e.userInfoObj=t,e.userInfoObj.head_start=0})):e.haslogin=!1}),o()(v,"beforeUpload",function(e){var t="video/mp4"===e.type;return t||this.$message.error("只能上传mp4格式的视频"),t}),o()(v,"handleClose",function(e){var t=this;this.loading||this.$confirm("确定要关闭表单吗？").then(function(s){t.loading=!0,t.timer=setTimeout(function(){e(),setTimeout(function(){t.loading=!1},400)},2e3)}).catch(function(e){})}),o()(v,"cancelForm",function(){this.loading=!1,this.dialog=!1,clearTimeout(this.timer)}),v),components:{"wbc-nav":i.a,social:f},watch:{$route:"routeChange"},created:function(){this.routeChange(),this.uploadURL=l.a.state.baseURL+"user/uploadAvatar",this.uploadURL1=l.a.state.baseURL+"video/uploadVideo",this.uploadURL2=l.a.state.baseURL+"video/uploadImage"}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("wbc-nav"),e._v(" "),s("div",{staticClass:"container"},[s("el-card",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],staticClass:"tcommonBox"},[s("header",[s("h1",[e._v("\n                    编辑个人资料\n                ")])]),e._v(" "),s("section",[s("ul",{staticClass:"userInfoBox"},[s("li",{staticClass:"avatarlist"},[s("span",{staticClass:"leftTitle"},[e._v("头像")]),e._v(" "),s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",action:e.uploadURL,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.userInfoObj.avatar?s("img",{staticClass:"avatar",attrs:{src:e.userInfoObj.avatar?e.userInfoObj.avatar:"static/img/tou.jpg",onerror:e.$store.state.errorImg}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("点击上传头像，只能上传jpg/png文件，且不超过1mb")])])],1),e._v(" "),s("li",{staticClass:"username"},[s("span",{staticClass:"leftTitle"},[e._v("昵称")]),e._v(" "),s("el-input",{attrs:{placeholder:"昵称"},model:{value:e.userInfoObj.nickName,callback:function(t){e.$set(e.userInfoObj,"nickName",t)},expression:"userInfoObj.nickName"}}),e._v(" "),s("i",{staticClass:"fa fa-wa fa-asterisk"})],1),e._v(" "),s("li",[s("span",{staticClass:"leftTitle"},[e._v("电子邮件")]),e._v(" "),s("span",[e._v(e._s(e.userInfoObj.email))])]),e._v(" "),s("li",[s("span",{staticClass:"leftTitle"},[e._v("性别")]),e._v(" "),[s("el-radio",{staticClass:"radio",attrs:{label:"0"},model:{value:e.userInfoObj.sex,callback:function(t){e.$set(e.userInfoObj,"sex",t)},expression:"userInfoObj.sex"}},[e._v("男")]),e._v(" "),s("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:e.userInfoObj.sex,callback:function(t){e.$set(e.userInfoObj,"sex",t)},expression:"userInfoObj.sex"}},[e._v("女")])]],2)]),e._v(" "),s("div",{staticClass:" saveInfobtn"},[s("a",{staticClass:"tcolors-bg",attrs:{href:"javascript:void(0);"},on:{click:function(t){e.isEdit=!e.isEdit}}},[e._v("返 回")]),e._v(" "),s("a",{staticClass:"tcolors-bg",attrs:{href:"javascript:void(0);"},on:{click:e.saveInfoFun}},[e._v("保 存")])])])]),e._v(" "),s("el-card",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],staticClass:"tcommonBox"},[s("header",[s("h1",[e._v("\n                    个人中心\n                    "),s("span",{staticClass:"gotoEdit",on:{click:function(t){e.isEdit=!e.isEdit}}},[s("i",{staticClass:"fa fa-wa fa-edit"}),e._v("编辑")])])]),e._v(" "),s("section",[s("ul",{staticClass:"userInfoBox"},[s("li",{staticClass:"avatarlist"},[s("span",{staticClass:"leftTitle"},[e._v("头像")]),e._v(" "),s("div",{staticClass:"avatar-uploader"},[s("img",{staticClass:"avatar",attrs:{src:e.userInfoObj.avatar?e.userInfoObj.avatar:"static/img/tou.jpg",onerror:e.$store.state.errorImg}})])]),e._v(" "),s("li",{staticClass:"username"},[s("span",{staticClass:"leftTitle"},[e._v("昵称")]),e._v(" "),s("span",[e._v(e._s(e.userInfoObj.nickName?e.userInfoObj.nickName:"无"))])]),e._v(" "),s("li",[s("span",{staticClass:"leftTitle"},[e._v("电子邮件")]),e._v(" "),s("span",[e._v(e._s(e.userInfoObj.email?e.userInfoObj.email:"无"))])]),e._v(" "),s("li",[s("span",{staticClass:"leftTitle"},[e._v("性别")]),e._v(" "),s("span",[e._v(e._s(0==e.userInfoObj.sex?"男":"女"))])]),e._v(" "),s("li",[s("el-button",{on:{click:function(t){e.isVideo=!0}}},[e._v("快来上传你的视频叭~~~")])],1)])])]),e._v(" "),s("el-dialog",{attrs:{title:"上传属于你自己的视频吧~~~",visible:e.isVideo,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.isVideo=t}}},[s("el-form",{ref:"video",attrs:{model:e.video,"label-width":"80px"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"缩略图"}},[s("el-upload",{staticClass:"upload-demo",attrs:{"file-list":e.fileList,"list-type":"picture",drag:"",name:"img",action:this.uploadURL2,"on-remove":e.fileRemove,limit:1,"http-request":e.handleUpload,"on-exceed":e.onExceed}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过2MB")])])],1)],1)],1),e._v(" "),s("el-row",[s("el-form-item",{attrs:{label:"视频"}},[s("el-upload",{staticClass:"upload-demo",attrs:{"file-list":e.fileList,"list-type":"picture",drag:"",name:"video",action:this.uploadURL1,"on-remove":e.fileRemove,limit:1,"http-request":e.handleUpload,"on-exceed":e.onExceed}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传mp4文件")])])],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"视频标题"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.video.videoTitle,callback:function(t){e.$set(e.video,"videoTitle",t)},expression:"video.videoTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"视频详情"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.video.videoInfo,callback:function(t){e.$set(e.video,"videoInfo",t)},expression:"video.videoInfo"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"视频类别"}},[s("el-checkbox-group",{model:{value:e.video.videoTypeId,callback:function(t){e.$set(e.video,"videoTypeId",t)},expression:"video.videoTypeId"}},[s("el-checkbox",{attrs:{label:"1",name:"type"}},[e._v("影视")]),e._v(" "),s("el-checkbox",{attrs:{label:"2",name:"type"}},[e._v("新闻")]),e._v(" "),s("el-checkbox",{attrs:{label:"3",name:"type"}},[e._v("生活")]),e._v(" "),s("el-checkbox",{attrs:{label:"4",name:"type"}},[e._v("美食")]),e._v(" "),s("el-checkbox",{attrs:{label:"5",name:"type"}},[e._v("音乐")]),e._v(" "),s("el-checkbox",{attrs:{label:"6",name:"type"}},[e._v("电视剧")]),e._v(" "),s("el-checkbox",{attrs:{label:"7",name:"type"}},[e._v("舞蹈")]),e._v(" "),s("el-checkbox",{attrs:{label:"8",name:"type"}},[e._v("动漫")]),e._v(" "),s("el-checkbox",{attrs:{label:"9",name:"type"}},[e._v("娱乐")]),e._v(" "),s("el-checkbox",{attrs:{label:"10",name:"type"}},[e._v("科技数码")]),e._v(" "),s("el-checkbox",{attrs:{label:"11",name:"type"}},[e._v("体育")]),e._v(" "),s("el-checkbox",{attrs:{label:"12",name:"type"}},[e._v("美妆")])],1)],1),e._v(" "),s("el-form-item")],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveVideo()}}},[e._v("立即创建")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isVideo=!e.isVideo}}},[e._v("取消")])],1)],1),e._v(" "),s("social")],1)],1)},staticRenderFns:[]};var h=s("VU/8")(m,p,!1,function(e){s("INfE")},null,null);t.default=h.exports},ubdi:function(e,t){}});