{"remainingRequest":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Download\\sg-vue-admin\\sg-vue-admin\\src\\utils\\downloadService.js","dependencies":[{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\src\\utils\\downloadService.js","mtime":1710555745796},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\babel.config.js","mtime":1710555740230},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRDpcXERvd25sb2FkXFxzZy12dWUtYWRtaW5cXHNnLXZ1ZS1hZG1pblxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcdHlwZW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnZWxlbWVudC11aSc7CmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJzsKYXhpb3MuZGVmYXVsdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04JzsgLy8g5Yib5bu6YXhpb3Plrp7kvosKCnZhciBkb3dubG9hZFNlcnZpY2UgPSBheGlvcy5jcmVhdGUoewogIC8vIGF4aW9z5Lit6K+35rGC6YWN572u5pyJYmFzZVVSTOmAiemhue+8jOihqOekuuivt+axglVSTOWFrOWFsemDqOWIhgogIGJhc2VVUkw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEksCiAgcmVzcG9uc2VUeXBlOiAnYmxvYicKfSk7IC8vIHJlcXVlc3Tmi6bmiKrlmagKCmRvd25sb2FkU2VydmljZS5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoZnVuY3Rpb24gKGNvbmZpZykgewogIC8vIOaYr+WQpumcgOimgeiuvue9riB0b2tlbgogIHZhciBpc1Rva2VuID0gKGNvbmZpZy5oZWFkZXJzIHx8IHt9KS5pc1Rva2VuID09PSBmYWxzZTsKCiAgaWYgKGdldFRva2VuKCkgJiYgIWlzVG9rZW4pIHsKICAgIGNvbmZpZy5oZWFkZXJzWyd0b2tlbiddID0gZ2V0VG9rZW4oKTsgLy8g6K6p5q+P5Liq6K+35rGC5pC65bim6Ieq5a6a5LmJdG9rZW4g6K+35qC55o2u5a6e6ZmF5oOF5Ya16Ieq6KGM5L+u5pS5CiAgfSAvLyBnZXTor7fmsYLmmKDlsIRwYXJhbXPlj4LmlbAKCgogIGlmIChjb25maWcubWV0aG9kID09PSAnZ2V0JyAmJiBjb25maWcucGFyYW1zKSB7CiAgICB2YXIgdXJsID0gY29uZmlnLnVybCArICc/JzsKCiAgICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3Qka2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZy5wYXJhbXMpOyBfaSA8IF9PYmplY3Qka2V5cy5sZW5ndGg7IF9pKyspIHsKICAgICAgdmFyIHByb3BOYW1lID0gX09iamVjdCRrZXlzW19pXTsKICAgICAgdmFyIHZhbHVlID0gY29uZmlnLnBhcmFtc1twcm9wTmFtZV07CiAgICAgIHZhciBwYXJ0ID0gZW5jb2RlVVJJQ29tcG9uZW50KHByb3BOYW1lKSArICc9JzsKCiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgaWYgKF90eXBlb2YodmFsdWUpID09PSAnb2JqZWN0JykgewogICAgICAgICAgZm9yICh2YXIgX2kyID0gMCwgX09iamVjdCRrZXlzMiA9IE9iamVjdC5rZXlzKHZhbHVlKTsgX2kyIDwgX09iamVjdCRrZXlzMi5sZW5ndGg7IF9pMisrKSB7CiAgICAgICAgICAgIHZhciBrZXkgPSBfT2JqZWN0JGtleXMyW19pMl07CgogICAgICAgICAgICBpZiAodmFsdWVba2V5XSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWVba2V5XSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gcHJvcE5hbWUgKyAnWycgKyBrZXkgKyAnXSc7CiAgICAgICAgICAgICAgdmFyIHN1YlBhcnQgPSBlbmNvZGVVUklDb21wb25lbnQocGFyYW1zKSArICc9JzsKICAgICAgICAgICAgICB1cmwgKz0gc3ViUGFydCArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZVtrZXldKSArICcmJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB1cmwgKz0gcGFydCArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdXJsID0gdXJsLnNsaWNlKDAsIC0xKTsKICAgIGNvbmZpZy5wYXJhbXMgPSB7fTsKICAgIGNvbmZpZy51cmwgPSB1cmw7CiAgfQoKICByZXR1cm4gY29uZmlnOwp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICBjb25zb2xlLmxvZyhlcnJvcik7CiAgUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsgLy8g5ZON5bqU5oum5oiq5ZmoCgpkb3dubG9hZFNlcnZpY2UuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzKSB7CiAgY29uc29sZS5sb2cocmVzKTsKCiAgaWYgKCFyZXMuZGF0YSkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIGJsb2IgPSBuZXcgQmxvYihbcmVzLmRhdGFdKTsKICB2YXIgY29udGVudERpc3Bvc2l0aW9uID0gcmVzLmhlYWRlcnNbJ2NvbnRlbnQtZGlzcG9zaXRpb24nXTsKICB2YXIgZmlsZU5hbWUgPSAndGVzdCc7CgogIGlmIChjb250ZW50RGlzcG9zaXRpb24pIHsKICAgIGZpbGVOYW1lID0gd2luZG93LmRlY29kZVVSSShyZXMuaGVhZGVyc1snY29udGVudC1kaXNwb3NpdGlvbiddLnNwbGl0KCc9JylbMV0sICdVVEYtOCcpOwogIH0KCiAgdmFyIHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogIHZhciBhTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICBhTGluay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIGFMaW5rLmhyZWYgPSB1cmw7CiAgYUxpbmsuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIGZpbGVOYW1lKTsKICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFMaW5rKTsKICBhTGluay5jbGljaygpOwogIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYUxpbmspOyAvLyDkuIvovb3lrozmiJDnp7vpmaTlhYPntKAKCiAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsgLy8g6YeK5pS+5o6JYmxvYuWvueixoQp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICBjb25zb2xlLmxvZygnZXJyJyArIGVycm9yKTsKICB2YXIgbWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7CgogIGlmIChtZXNzYWdlID09PSAnTmV0d29yayBFcnJvcicpIHsKICAgIG1lc3NhZ2UgPSAn5ZCO56uv5o6l5Y+j6L+e5o6l5byC5bi4JzsKICB9IGVsc2UgaWYgKG1lc3NhZ2UuaW5jbHVkZXMoJ3RpbWVvdXQnKSkgewogICAgbWVzc2FnZSA9ICfns7vnu5/mjqXlj6Por7fmsYLotoXml7YnOwogIH0gZWxzZSBpZiAobWVzc2FnZS5pbmNsdWRlcygnUmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgY29kZScpKSB7CiAgICBtZXNzYWdlID0gJ+ezu+e7n+aOpeWPoycgKyBtZXNzYWdlLnN1YnN0cihtZXNzYWdlLmxlbmd0aCAtIDMpICsgJ+W8guW4uCc7CiAgfQoKICBNZXNzYWdlKHsKICAgIG1lc3NhZ2U6IG1lc3NhZ2UsCiAgICB0eXBlOiAnZXJyb3InLAogICAgZHVyYXRpb246IDUgKiAxMDAwCiAgfSk7CiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7CmV4cG9ydCBkZWZhdWx0IGRvd25sb2FkU2VydmljZTs="},{"version":3,"sources":["D:/Download/sg-vue-admin/sg-vue-admin/src/utils/downloadService.js"],"names":["axios","Message","getToken","defaults","headers","downloadService","create","baseURL","process","env","VUE_APP_BASE_API","responseType","interceptors","request","use","config","isToken","method","params","url","Object","keys","propName","value","part","encodeURIComponent","key","subPart","slice","error","console","log","Promise","reject","response","res","data","blob","Blob","contentDisposition","fileName","window","decodeURI","split","URL","createObjectURL","aLink","document","createElement","style","display","href","setAttribute","body","appendChild","click","removeChild","revokeObjectURL","message","includes","substr","length","type","duration"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport { Message } from 'element-ui'\r\nimport { getToken } from '@/utils/auth'\r\n\r\naxios.defaults.headers['Content-Type'] = 'application/json;charset=utf-8'\r\n// 创建axios实例\r\nconst downloadService = axios.create({\r\n  // axios中请求配置有baseURL选项，表示请求URL公共部分\r\n  baseURL: process.env.VUE_APP_BASE_API,\r\n  responseType: 'blob'\r\n})\r\n\r\n// request拦截器\r\ndownloadService.interceptors.request.use(config => {\r\n  // 是否需要设置 token\r\n  const isToken = (config.headers || {}).isToken === false\r\n  if (getToken() && !isToken) {\r\n    config.headers['token'] = getToken() // 让每个请求携带自定义token 请根据实际情况自行修改\r\n  }\r\n  // get请求映射params参数\r\n  if (config.method === 'get' && config.params) {\r\n    let url = config.url + '?'\r\n    for (const propName of Object.keys(config.params)) {\r\n      const value = config.params[propName]\r\n      var part = encodeURIComponent(propName) + '='\r\n      if (value !== null && typeof (value) !== 'undefined') {\r\n        if (typeof value === 'object') {\r\n          for (const key of Object.keys(value)) {\r\n            if (value[key] !== null && typeof (value[key]) !== 'undefined') {\r\n              const params = propName + '[' + key + ']'\r\n              const subPart = encodeURIComponent(params) + '='\r\n              url += subPart + encodeURIComponent(value[key]) + '&'\r\n            }\r\n          }\r\n        } else {\r\n          url += part + encodeURIComponent(value) + '&'\r\n        }\r\n      }\r\n    }\r\n    url = url.slice(0, -1)\r\n    config.params = {}\r\n    config.url = url\r\n  }\r\n  return config\r\n}, error => {\r\n  console.log(error)\r\n  Promise.reject(error)\r\n})\r\n\r\n// 响应拦截器\r\ndownloadService.interceptors.response.use(res => {\r\n  console.log(res)\r\n  if (!res.data) {\r\n    return\r\n  }\r\n  var blob = new Blob([res.data])\r\n  const contentDisposition = res.headers['content-disposition']\r\n  var fileName = 'test'\r\n  if (contentDisposition) {\r\n    fileName = window.decodeURI(res.headers['content-disposition'].split('=')[1], 'UTF-8')\r\n  }\r\n  var url = window.URL.createObjectURL(blob)\r\n  var aLink = document.createElement('a')\r\n  aLink.style.display = 'none'\r\n  aLink.href = url\r\n  aLink.setAttribute('download', fileName)\r\n  document.body.appendChild(aLink)\r\n  aLink.click()\r\n  document.body.removeChild(aLink) // 下载完成移除元素\r\n  window.URL.revokeObjectURL(url) // 释放掉blob对象\r\n},\r\nerror => {\r\n  console.log('err' + error)\r\n  let { message } = error\r\n  if (message === 'Network Error') {\r\n    message = '后端接口连接异常'\r\n  } else if (message.includes('timeout')) {\r\n    message = '系统接口请求超时'\r\n  } else if (message.includes('Request failed with status code')) {\r\n    message = '系统接口' + message.substr(message.length - 3) + '异常'\r\n  }\r\n  Message({\r\n    message: message,\r\n    type: 'error',\r\n    duration: 5 * 1000\r\n  })\r\n  return Promise.reject(error)\r\n}\r\n)\r\n\r\nexport default downloadService\r\n\r\n"]}]}