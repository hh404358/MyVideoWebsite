{"remainingRequest":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Download\\sg-vue-admin\\sg-vue-admin\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\src\\store\\modules\\user.js","mtime":1710555745449},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\babel.config.js","mtime":1710555740230},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Download\\sg-vue-admin\\sg-vue-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCB7IGxvZ2luLCBsb2dvdXQsIGdldEluZm8gfSBmcm9tICdAL2FwaS9sb2dpbic7CmltcG9ydCB7IGdldFRva2VuLCBzZXRUb2tlbiwgcmVtb3ZlVG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOwp2YXIgdXNlciA9IHsKICBzdGF0ZTogewogICAgdG9rZW46IGdldFRva2VuKCksCiAgICBuYW1lOiAnJywKICAgIGF2YXRhcjogJycsCiAgICByb2xlczogW10sCiAgICBwZXJtaXNzaW9uczogW10KICB9LAogIG11dGF0aW9uczogewogICAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgICB9LAogICAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBuYW1lKSB7CiAgICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogICAgfSwKICAgIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgICB9LAogICAgU0VUX1JPTEVTOiBmdW5jdGlvbiBTRVRfUk9MRVMoc3RhdGUsIHJvbGVzKSB7CiAgICAgIHN0YXRlLnJvbGVzID0gcm9sZXM7CiAgICB9LAogICAgU0VUX1BFUk1JU1NJT05TOiBmdW5jdGlvbiBTRVRfUEVSTUlTU0lPTlMoc3RhdGUsIHBlcm1pc3Npb25zKSB7CiAgICAgIHN0YXRlLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICAvLyDnmbvlvZUKICAgIExvZ2luOiBmdW5jdGlvbiBMb2dpbihfcmVmLCB1c2VySW5mbykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJOYW1lLnRyaW0oKTsKICAgICAgdmFyIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICAgIHZhciBjb2RlID0gdXNlckluZm8uY29kZTsKICAgICAgdmFyIHV1aWQgPSB1c2VySW5mby51dWlkOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCwgY29kZSwgdXVpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBzZXRUb2tlbihyZXMudG9rZW4pOwogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCByZXMudG9rZW4pOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6I635Y+W55So5oi35L+h5oGvCiAgICBHZXRJbmZvOiBmdW5jdGlvbiBHZXRJbmZvKF9yZWYyKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGdldEluZm8oKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIHZhciB1c2VyID0gcmVzLnVzZXI7CiAgICAgICAgICB2YXIgYXZhdGFyID0gdXNlci5hdmF0YXIgPT09ICcnID8gcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL3Byb2ZpbGUuanBnJykgOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJICsgdXNlci5hdmF0YXI7CgogICAgICAgICAgaWYgKHJlcy5yb2xlcyAmJiByZXMucm9sZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAvLyDpqozor4Hov5Tlm57nmoRyb2xlc+aYr+WQpuaYr+S4gOS4qumdnuepuuaVsOe7hAogICAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIHJlcy5yb2xlcyk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1BFUk1JU1NJT05TJywgcmVzLnBlcm1pc3Npb25zKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgWydST0xFX0RFRkFVTFQnXSk7CiAgICAgICAgICB9CgogICAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIHVzZXIudXNlck5hbWUpOwogICAgICAgICAgY29tbWl0KCdTRVRfQVZBVEFSJywgYXZhdGFyKTsKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOmAgOWHuuezu+e7nwogICAgTG9nT3V0OiBmdW5jdGlvbiBMb2dPdXQoX3JlZjMpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdCwKICAgICAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgbG9nb3V0KHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBbXSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9QRVJNSVNTSU9OUycsIFtdKTsKICAgICAgICAgIHJlbW92ZVRva2VuKCk7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDliY3nq68g55m75Ye6CiAgICBGZWRMb2dPdXQ6IGZ1bmN0aW9uIEZlZExvZ091dChfcmVmNCkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKTsKICAgICAgICByZW1vdmVUb2tlbigpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB1c2VyOw=="},{"version":3,"sources":["D:/Download/sg-vue-admin/sg-vue-admin/src/store/modules/user.js"],"names":["login","logout","getInfo","getToken","setToken","removeToken","user","state","token","name","avatar","roles","permissions","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_PERMISSIONS","actions","Login","userInfo","commit","username","userName","trim","password","code","uuid","Promise","resolve","reject","then","res","catch","error","GetInfo","require","process","env","VUE_APP_BASE_API","length","LogOut","FedLogOut"],"mappings":"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","sourcesContent":["import { login, logout, getInfo } from '@/api/login'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\n\r\nconst user = {\r\n  state: {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: [],\r\n    permissions: []\r\n  },\r\n\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    },\r\n    SET_PERMISSIONS: (state, permissions) => {\r\n      state.permissions = permissions\r\n    }\r\n  },\r\n\r\n  actions: {\r\n    // 登录\r\n    Login({ commit }, userInfo) {\r\n      const username = userInfo.userName.trim()\r\n      const password = userInfo.password\r\n      const code = userInfo.code\r\n      const uuid = userInfo.uuid\r\n      return new Promise((resolve, reject) => {\r\n        login(username, password, code, uuid).then(res => {\r\n          setToken(res.token)\r\n          commit('SET_TOKEN', res.token)\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    GetInfo({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getInfo().then(res => {\r\n          const user = res.user\r\n          const avatar = user.avatar === '' ? require('@/assets/images/profile.jpg') : process.env.VUE_APP_BASE_API + user.avatar\r\n          if (res.roles && res.roles.length > 0) { // 验证返回的roles是否是一个非空数组\r\n            commit('SET_ROLES', res.roles)\r\n            commit('SET_PERMISSIONS', res.permissions)\r\n          } else {\r\n            commit('SET_ROLES', ['ROLE_DEFAULT'])\r\n          }\r\n          commit('SET_NAME', user.userName)\r\n          commit('SET_AVATAR', avatar)\r\n          resolve(res)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 退出系统\r\n    LogOut({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout(state.token).then(() => {\r\n          commit('SET_TOKEN', '')\r\n          commit('SET_ROLES', [])\r\n          commit('SET_PERMISSIONS', [])\r\n          removeToken()\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 前端 登出\r\n    FedLogOut({ commit }) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', '')\r\n        removeToken()\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default user\r\n"]}]}